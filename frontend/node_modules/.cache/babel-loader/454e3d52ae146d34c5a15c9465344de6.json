{"remainingRequest":"/home/kien/Documents/blockchain-research/tezos-certificate/frontend/node_modules/thread-loader/dist/cjs.js!/home/kien/Documents/blockchain-research/tezos-certificate/frontend/node_modules/babel-loader/lib/index.js!/home/kien/Documents/blockchain-research/tezos-certificate/frontend/node_modules/eslint-loader/index.js??ref--13-0!/home/kien/Documents/blockchain-research/tezos-certificate/frontend/src/requests/foundation/BaseRequest.js","dependencies":[{"path":"/home/kien/Documents/blockchain-research/tezos-certificate/frontend/src/requests/foundation/BaseRequest.js","mtime":1601824685399},{"path":"/home/kien/Documents/blockchain-research/tezos-certificate/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/kien/Documents/blockchain-research/tezos-certificate/frontend/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/kien/Documents/blockchain-research/tezos-certificate/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/kien/Documents/blockchain-research/tezos-certificate/frontend/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiL2hvbWUva2llbi9Eb2N1bWVudHMvYmxvY2tjaGFpbi1yZXNlYXJjaC90ZXpvcy1jZXJ0aWZpY2F0ZS9mcm9udGVuZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9ob21lL2tpZW4vRG9jdW1lbnRzL2Jsb2NrY2hhaW4tcmVzZWFyY2gvdGV6b3MtY2VydGlmaWNhdGUvZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF8gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IGF1dGggZnJvbSAnLi9BdXRoZW50aWNhdG9yJzsgLy8gUHJvbWlzZWQtYmFzZWQgcmVxdWVzdAoKdmFyIEJhc2VSZXF1ZXN0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICBmdW5jdGlvbiBCYXNlUmVxdWVzdCgpIHsKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCYXNlUmVxdWVzdCk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQmFzZVJlcXVlc3QsIFt7CiAgICBrZXk6ICJnZXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldCh1cmwsIHBhcmFtcykgewogICAgICByZXR1cm4gdGhpcy5fZG9TZWxmUmVxdWVzdCgnR0VUJywgdXJsLCB7CiAgICAgICAgcGFyYW1zOiBwYXJhbXMKICAgICAgfSk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZGVsZXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKHVybCkgewogICAgICB2YXIgcGFyYW1zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTsKICAgICAgcmV0dXJuIHRoaXMuX2RvU2VsZlJlcXVlc3QoJ0RFTEVURScsIHVybCwgewogICAgICAgIHBhcmFtczogcGFyYW1zCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInB1dCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcHV0KHVybCkgewogICAgICB2YXIgZGF0YSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CiAgICAgIHJldHVybiB0aGlzLl9kb1NlbGZSZXF1ZXN0KCdQVVQnLCB1cmwsIHsKICAgICAgICBkYXRhOiBkYXRhCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInBvc3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHBvc3QodXJsKSB7CiAgICAgIHZhciBkYXRhID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTsKICAgICAgcmV0dXJuIHRoaXMuX2RvU2VsZlJlcXVlc3QoJ1BPU1QnLCB1cmwsIHsKICAgICAgICBkYXRhOiBkYXRhCiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogIl9kb1NlbGZSZXF1ZXN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZG9TZWxmUmVxdWVzdChtZXRob2QsIHVybCwgcGFyYW1zQ29uZmlnKSB7CiAgICAgIHJldHVybiB0aGlzLl9kb1JlcXVlc3QobWV0aG9kLCB1cmwsIHBhcmFtc0NvbmZpZyk7CiAgICB9CiAgfSwgewogICAga2V5OiAiX2RvUmVxdWVzdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2RvUmVxdWVzdChtZXRob2QsIHVybCwgcGFyYW1zQ29uZmlnKSB7CiAgICAgIHZhciBoZWFkZXJzID0gewogICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsCiAgICAgICAgJ0NvbnRlbnQtdHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAgICAnQXV0aG9yaXphdGlvbic6ICdCZWFyZXIgJyArIHRoaXMuX2dldEF1dGhUb2tlbigpCiAgICAgIH07CgogICAgICB2YXIgY29uZmlnID0gXy5hc3NpZ24oewogICAgICAgIG1ldGhvZDogbWV0aG9kLAogICAgICAgIHVybDogdXJsLAogICAgICAgIGhlYWRlcnM6IGhlYWRlcnMKICAgICAgfSwgcGFyYW1zQ29uZmlnKTsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgIGF4aW9zKGNvbmZpZykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIGlmICghcmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgICB3aW5kb3cuRXZlbnRCdXMuJGVtaXQoJ0VSUk9SJywgJ0ludmFsaWQgcmVzcG9uc2UgZm9ybWF0OiAnICsgcmVzcG9uc2UpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgcmVzb2x2ZShyZXNwb25zZS5kYXRhKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICBpZiAoZXJyLnJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgIHJldHVybiBhdXRoLnJlbW92ZVVzZXIoKTsKICAgICAgICAgIH0KCiAgICAgICAgICB3aW5kb3cuRXZlbnRCdXMuJGVtaXQoJ0VSUk9SJywgZXJyLnJlc3BvbnNlLmRhdGEuZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJfZ2V0QXV0aFRva2VuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0QXV0aFRva2VuKCkgewogICAgICBpZiAoIWF1dGguX3VzZXIpIHsKICAgICAgICByZXR1cm4gJyc7CiAgICAgIH0KCiAgICAgIHJldHVybiBhdXRoLl91c2VyLnRva2VuOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEJhc2VSZXF1ZXN0Owp9KCk7CgpleHBvcnQgeyBCYXNlUmVxdWVzdCBhcyBkZWZhdWx0IH07"},{"version":3,"sources":["/home/kien/Documents/blockchain-research/tezos-certificate/frontend/src/requests/foundation/BaseRequest.js"],"names":["_","axios","auth","BaseRequest","url","params","_doSelfRequest","data","method","paramsConfig","_doRequest","headers","_getAuthToken","config","assign","Promise","resolve","then","response","window","EventBus","$emit","catch","err","status","removeUser","error","_user","token"],"mappings":";;;AAAA,OAAOA,CAAP,MAAc,QAAd;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,IAAP,MAAiB,iBAAjB,C,CAEA;;IACqBC,W;;;;;;;wBACdC,G,EAAKC,M,EAAQ;AAChB,aAAO,KAAKC,cAAL,CAAoB,KAApB,EAA2BF,GAA3B,EAAgC;AAAEC,QAAAA,MAAM,EAANA;AAAF,OAAhC,CAAP;AACD;;;4BAEOD,G,EAAkB;AAAA,UAAbC,MAAa,uEAAJ,EAAI;AACxB,aAAO,KAAKC,cAAL,CAAoB,QAApB,EAA8BF,GAA9B,EAAmC;AAAEC,QAAAA,MAAM,EAANA;AAAF,OAAnC,CAAP;AACD;;;wBAEID,G,EAAgB;AAAA,UAAXG,IAAW,uEAAJ,EAAI;AACnB,aAAO,KAAKD,cAAL,CAAoB,KAApB,EAA2BF,GAA3B,EAAgC;AAAEG,QAAAA,IAAI,EAAJA;AAAF,OAAhC,CAAP;AACD;;;yBAEKH,G,EAAgB;AAAA,UAAXG,IAAW,uEAAJ,EAAI;AACpB,aAAO,KAAKD,cAAL,CAAoB,MAApB,EAA4BF,GAA5B,EAAiC;AAAEG,QAAAA,IAAI,EAAJA;AAAF,OAAjC,CAAP;AACD;;;mCAEeC,M,EAAQJ,G,EAAKK,Y,EAAc;AACzC,aAAO,KAAKC,UAAL,CAAgBF,MAAhB,EAAwBJ,GAAxB,EAA6BK,YAA7B,CAAP;AACD;;;+BAEWD,M,EAAQJ,G,EAAKK,Y,EAAc;AACrC,UAAME,OAAO,GAAG;AACd,kBAAU,kBADI;AAEd,wBAAgB,kBAFF;AAGd,yBAAiB,YAAY,KAAKC,aAAL;AAHf,OAAhB;;AAMA,UAAMC,MAAM,GAAGb,CAAC,CAACc,MAAF,CAAS;AACtBN,QAAAA,MAAM,EAANA,MADsB;AAEtBJ,QAAAA,GAAG,EAAHA,GAFsB;AAGtBO,QAAAA,OAAO,EAAPA;AAHsB,OAAT,EAIZF,YAJY,CAAf;;AAKA,aAAO,IAAIM,OAAJ,CAAY,UAACC,OAAD,EAAa;AAC9Bf,QAAAA,KAAK,CAACY,MAAD,CAAL,CACGI,IADH,CACQ,UAAAC,QAAQ,EAAI;AAChB,cAAI,CAACA,QAAQ,CAACX,IAAd,EAAoB;AAClBY,YAAAA,MAAM,CAACC,QAAP,CAAgBC,KAAhB,CAAsB,OAAtB,EAA+B,8BAA8BH,QAA7D;AACA;AACD;;AACDF,UAAAA,OAAO,CAACE,QAAQ,CAACX,IAAV,CAAP;AACD,SAPH,EAQGe,KARH,CAQS,UAAAC,GAAG,EAAI;AACZ,cAAIA,GAAG,CAACL,QAAJ,CAAaM,MAAb,KAAwB,GAA5B,EAAiC;AAC/B,mBAAOtB,IAAI,CAACuB,UAAL,EAAP;AACD;;AACDN,UAAAA,MAAM,CAACC,QAAP,CAAgBC,KAAhB,CAAsB,OAAtB,EAA+BE,GAAG,CAACL,QAAJ,CAAaX,IAAb,CAAkBmB,KAAjD;AACD,SAbH;AAcD,OAfM,CAAP;AAgBD;;;oCAEgB;AACf,UAAI,CAACxB,IAAI,CAACyB,KAAV,EAAiB;AACf,eAAO,EAAP;AACD;;AAED,aAAOzB,IAAI,CAACyB,KAAL,CAAWC,KAAlB;AACD;;;;;;SAzDkBzB,W","sourcesContent":["import _ from 'lodash';\nimport axios from 'axios';\nimport auth from './Authenticator';\n\n// Promised-based request\nexport default class BaseRequest {\n  get (url, params) {\n    return this._doSelfRequest('GET', url, { params });\n  }\n\n  delete (url, params = {}) {\n    return this._doSelfRequest('DELETE', url, { params });\n  }\n\n  put (url, data = {}) {\n    return this._doSelfRequest('PUT', url, { data });\n  }\n\n  post (url, data = {}) {\n    return this._doSelfRequest('POST', url, { data });\n  }\n\n  _doSelfRequest (method, url, paramsConfig) {\n    return this._doRequest(method, url, paramsConfig);\n  }\n\n  _doRequest (method, url, paramsConfig) {\n    const headers = {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n      'Authorization': 'Bearer ' + this._getAuthToken()\n    };\n\n    const config = _.assign({\n      method,\n      url,\n      headers\n    }, paramsConfig);\n    return new Promise((resolve) => {\n      axios(config)\n        .then(response => {\n          if (!response.data) {\n            window.EventBus.$emit('ERROR', 'Invalid response format: ' + response);\n            return;\n          }\n          resolve(response.data);\n        })\n        .catch(err => {\n          if (err.response.status === 401) {\n            return auth.removeUser()\n          }\n          window.EventBus.$emit('ERROR', err.response.data.error)\n        });\n    });\n  }\n\n  _getAuthToken () {\n    if (!auth._user) {\n      return ''\n    }\n\n    return auth._user.token\n  }\n}\n"]}]}