{"remainingRequest":"/home/kien/Documents/blockchain-research/tezos-certificate/frontend/node_modules/babel-loader/lib/index.js!/home/kien/Documents/blockchain-research/tezos-certificate/frontend/node_modules/eslint-loader/index.js??ref--13-0!/home/kien/Documents/blockchain-research/tezos-certificate/frontend/src/requests/foundation/Authenticator.js","dependencies":[{"path":"/home/kien/Documents/blockchain-research/tezos-certificate/frontend/src/requests/foundation/Authenticator.js","mtime":1601825676754},{"path":"/home/kien/Documents/blockchain-research/tezos-certificate/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/kien/Documents/blockchain-research/tezos-certificate/frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/kien/Documents/blockchain-research/tezos-certificate/frontend/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiL2hvbWUva2llbi9Eb2N1bWVudHMvYmxvY2tjaGFpbi1yZXNlYXJjaC90ZXpvcy1jZXJ0aWZpY2F0ZS9mcm9udGVuZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIi9ob21lL2tpZW4vRG9jdW1lbnRzL2Jsb2NrY2hhaW4tcmVzZWFyY2gvdGV6b3MtY2VydGlmaWNhdGUvZnJvbnRlbmQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF8gZnJvbSAnbG9kYXNoJzsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwoKdmFyIEF1dGhlbnRpY2F0b3IgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEF1dGhlbnRpY2F0b3IoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQXV0aGVudGljYXRvcik7CgogICAgdGhpcy5faW5pdCgpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEF1dGhlbnRpY2F0b3IsIFt7CiAgICBrZXk6ICJfaW5pdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gX2luaXQoKSB7CiAgICAgIHZhciBzdG9yZWRVc2VyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXInKTsKCiAgICAgIGlmIChzdG9yZWRVc2VyKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgIHRoaXMuX3VzZXIgPSBKU09OLnBhcnNlKHN0b3JlZFVzZXIpOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdJbnZhbGlkIHN0b3JlZCB1c2VyOiAnICsgc3RvcmVkVXNlcik7CiAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndXNlcicpOwogICAgICAgICAgdGhpcy5fdXNlciA9IG51bGw7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gdGhpczsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsb2dJbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9nSW4ocGFyYW1zKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICBheGlvcy5wb3N0KCIiLmNvbmNhdChwcm9jZXNzLmVudi5WVUVfQVBQX1NFUlZFUl9VUkwsICIvYXBpL3VzZXIvbG9naW4iKSwgcGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgdmFyIHVzZXIgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgdmFyIHVzZXJEYXRhID0gSlNPTi5zdHJpbmdpZnkodXNlcik7CiAgICAgICAgICBfdGhpcy5fdXNlciA9IEpTT04ucGFyc2UodXNlckRhdGEpOwogICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXInLCB1c2VyRGF0YSk7CiAgICAgICAgICByZXNvbHZlKHVzZXIpOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgIHdpbmRvdy5FdmVudEJ1cy4kZW1pdCgnRVJST1InLCBlcnIucmVzcG9uc2UuZGF0YS5lcnJvcik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImxvZ091dCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9nT3V0KCkgewogICAgICBjb25zb2xlLmxvZygnPT09PT4nLCB0aGlzLl91c2VyLnRva2VuKTsKICAgICAgdmFyIGhlYWRlcnMgPSB7CiAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAgICAnQ29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICdBdXRob3JpemF0aW9uJzogJ0JlYXJlciAnICsgdGhpcy5fdXNlci50b2tlbgogICAgICB9OwoKICAgICAgdmFyIGNvbmZpZyA9IF8uYXNzaWduKHsKICAgICAgICBtZXRob2Q6ICdwb3N0JywKICAgICAgICB1cmw6ICIiLmNvbmNhdChwcm9jZXNzLmVudi5WVUVfQVBQX1NFUlZFUl9VUkwsICIvYXBpL3VzZXIvbG9nb3V0IiksCiAgICAgICAgaGVhZGVyczogaGVhZGVycwogICAgICB9KTsKCiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd1c2VyJyk7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgIGNvbnNvbGUubG9nKCdpaWlpaWlpaWlpaWlpaWlpaWlpaWlpJyk7CiAgICAgICAgYXhpb3MoY29uZmlnKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgcmVzb2x2ZShyZXNwb25zZS5kYXRhKTsKICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9XSk7CgogIHJldHVybiBBdXRoZW50aWNhdG9yOwp9KCk7Cgp2YXIgYXV0aCA9IG5ldyBBdXRoZW50aWNhdG9yKCk7ClZ1ZS5wcm90b3R5cGUuJGF1dGggPSBhdXRoOwpleHBvcnQgZGVmYXVsdCBhdXRoOw=="},{"version":3,"sources":["/home/kien/Documents/blockchain-research/tezos-certificate/frontend/src/requests/foundation/Authenticator.js"],"names":["_","axios","Vue","Authenticator","_init","storedUser","localStorage","getItem","_user","JSON","parse","e","console","log","removeItem","params","Promise","resolve","post","process","env","VUE_APP_SERVER_URL","then","response","user","data","userData","stringify","setItem","catch","err","window","EventBus","$emit","error","token","headers","config","assign","method","url","auth","prototype","$auth"],"mappings":";;;AAAA,OAAOA,CAAP,MAAc,QAAd;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,GAAP,MAAgB,KAAhB;;IAEMC,a;AACJ,2BAAe;AAAA;;AACb,SAAKC,KAAL;AACD;;;;4BAEQ;AACP,UAAMC,UAAU,GAAGC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAnB;;AACA,UAAIF,UAAJ,EAAgB;AACd,YAAI;AACF,eAAKG,KAAL,GAAaC,IAAI,CAACC,KAAL,CAAWL,UAAX,CAAb;AACD,SAFD,CAEE,OAAOM,CAAP,EAAU;AACVC,UAAAA,OAAO,CAACC,GAAR,CAAY,0BAA0BR,UAAtC;AACAC,UAAAA,YAAY,CAACQ,UAAb,CAAwB,MAAxB;AACA,eAAKN,KAAL,GAAa,IAAb;AACD;AACF;;AAED,aAAO,IAAP;AACD;;;0BAEMO,M,EAAQ;AAAA;;AACb,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAa;AAC9BhB,QAAAA,KAAK,CAACiB,IAAN,WAAcC,OAAO,CAACC,GAAR,CAAYC,kBAA1B,sBAA+DN,MAA/D,EACGO,IADH,CACQ,UAAAC,QAAQ,EAAI;AAChB,cAAMC,IAAI,GAAGD,QAAQ,CAACE,IAAtB;AACA,cAAMC,QAAQ,GAAGjB,IAAI,CAACkB,SAAL,CAAeH,IAAf,CAAjB;AACA,UAAA,KAAI,CAAChB,KAAL,GAAaC,IAAI,CAACC,KAAL,CAAWgB,QAAX,CAAb;AACApB,UAAAA,YAAY,CAACsB,OAAb,CAAqB,MAArB,EAA6BF,QAA7B;AACAT,UAAAA,OAAO,CAACO,IAAD,CAAP;AACD,SAPH,EAQGK,KARH,CAQS,UAAAC,GAAG,EAAI;AACZC,UAAAA,MAAM,CAACC,QAAP,CAAgBC,KAAhB,CAAsB,OAAtB,EAA+BH,GAAG,CAACP,QAAJ,CAAaE,IAAb,CAAkBS,KAAjD;AACD,SAVH;AAWD,OAZM,CAAP;AAaD;;;6BAES;AACRtB,MAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ,EAAqB,KAAKL,KAAL,CAAW2B,KAAhC;AACA,UAAMC,OAAO,GAAG;AACd,kBAAU,kBADI;AAEd,wBAAgB,kBAFF;AAGd,yBAAiB,YAAY,KAAK5B,KAAL,CAAW2B;AAH1B,OAAhB;;AAKA,UAAME,MAAM,GAAGrC,CAAC,CAACsC,MAAF,CAAS;AACtBC,QAAAA,MAAM,EAAE,MADc;AAEtBC,QAAAA,GAAG,YAAKrB,OAAO,CAACC,GAAR,CAAYC,kBAAjB,qBAFmB;AAGtBe,QAAAA,OAAO,EAAPA;AAHsB,OAAT,CAAf;;AAKA9B,MAAAA,YAAY,CAACQ,UAAb,CAAwB,MAAxB;AACA,aAAO,IAAIE,OAAJ,CAAY,UAACC,OAAD,EAAa;AAC9BL,QAAAA,OAAO,CAACC,GAAR,CAAY,wBAAZ;AACAZ,QAAAA,KAAK,CAACoC,MAAD,CAAL,CACCf,IADD,CACM,UAAAC,QAAQ,EAAI;AAChBN,UAAAA,OAAO,CAACM,QAAQ,CAACE,IAAV,CAAP;AACD,SAHD,EAICI,KAJD,CAIO,UAAAC,GAAG,EAAI;AACZlB,UAAAA,OAAO,CAACC,GAAR,CAAYiB,GAAZ;AACD,SAND;AAOD,OATM,CAAP;AAUD;;;;;;AAGH,IAAMW,IAAI,GAAG,IAAItC,aAAJ,EAAb;AACAD,GAAG,CAACwC,SAAJ,CAAcC,KAAd,GAAsBF,IAAtB;AACA,eAAeA,IAAf","sourcesContent":["import _ from 'lodash'\nimport axios from 'axios'\nimport Vue from 'vue'\n\nclass Authenticator {\n  constructor () {\n    this._init()\n  }\n\n  _init () {\n    const storedUser = localStorage.getItem('user')\n    if (storedUser) {\n      try {\n        this._user = JSON.parse(storedUser)\n      } catch (e) {\n        console.log('Invalid stored user: ' + storedUser)\n        localStorage.removeItem('user')\n        this._user = null\n      }\n    }\n\n    return this\n  }\n\n  logIn (params) {\n    return new Promise((resolve) => {\n      axios.post(`${process.env.VUE_APP_SERVER_URL}/api/user/login`, params)\n        .then(response => {\n          const user = response.data\n          const userData = JSON.stringify(user)\n          this._user = JSON.parse(userData)\n          localStorage.setItem('user', userData)\n          resolve(user)\n        })\n        .catch(err => {\n          window.EventBus.$emit('ERROR', err.response.data.error)\n        });\n    });\n  }\n\n  logOut () {\n    console.log('====>', this._user.token)\n    const headers = {\n      'Accept': 'application/json',\n      'Content-type': 'application/json',\n      'Authorization': 'Bearer ' + this._user.token\n    };\n    const config = _.assign({\n      method: 'post',\n      url: `${process.env.VUE_APP_SERVER_URL}/api/user/logout`,\n      headers\n    });\n    localStorage.removeItem('user')\n    return new Promise((resolve) => {\n      console.log('iiiiiiiiiiiiiiiiiiiiii')\n      axios(config)\n      .then(response => {\n        resolve(response.data)\n      })\n      .catch(err => {\n        console.log(err)\n      })\n    })\n  }\n}\n\nconst auth = new Authenticator()\nVue.prototype.$auth = auth\nexport default auth\n"]}]}